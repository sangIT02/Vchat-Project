<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>B·∫°n b√® | VChat</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="icon" type="image/png" href="../images/logo.png" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link href="../CSS/main.css" rel="stylesheet" />
    <link rel="stylesheet" href="../CSS/darkmode.css" />
    <link rel="stylesheet" href="../CSS/mess.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
    />
    <style>
      body {
        background-color: #f2f4f7;
        transition: background-color 0.3s, color 0.3s;
      }

      .post {
        background-color: white;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 15px;
        transition: background-color 0.3s;
      }
      .left-sidebar {
        background-color: #f8f9fa;
        transition: background-color 0.3s, color 0.3s;
      }

      .left-sidebar .nav-link {
        padding: 10px 15px;
        font-weight: 500;
        color: #444;
        border-radius: 10px;
        transition: all 0.2s;
      }

      .left-sidebar .nav-link i {
        margin-right: 8px;
      }

      .left-sidebar .nav-link:hover {
        background-color: #e4e6eb;
        color: #000;
      }

      .left-sidebar .nav-link.active {
        background-color: #1877f2;
        color: #fff;
      }

      /* Dark mode */
      body.dark-mode .left-sidebar {
        background-color: #1e1e1e;
        color: #ddd;
      }

      body.dark-mode .left-sidebar .nav-link {
        color: #ccc;
      }

      body.dark-mode .left-sidebar .nav-link:hover {
        background-color: #333;
        color: #fff;
      }

      body.dark-mode .left-sidebar .nav-link.active {
        background-color: #3a3b3c;
        color: #fff;
      }
      .nav.flex-column .nav-link i {
        font-size: 1.2rem;
      }
      .friend-card {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
        transition: box-shadow 0.3s ease;
      }

      .friend-card:hover {
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.35);
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <nav
      class="navbar navbar-expand-lg navbar-light bg-white shadow-sm sticky-top"
    >
      <div
        class="container-fluid d-flex flex-nowrap align-items-center justify-content-between"
      >
        <!-- LOGO + SEARCH -->
        <div class="d-flex align-items-center flex-grow-1 flex-md-grow-0">
          <!-- Logo -->
          <a href="index.html" class="me-2">
            <img
              class="rounded-circle"
              style="width: 40px; height: 40px"
              src="../images/logo.png"
              alt="logo"
            />
          </a>

          <!-- T√¨m ki·∫øm (·∫©n tr√™n mobile) -->
          <form
            class="d-md-none d-lg-flex ms-2"
            style="position: relative; width: 250px"
          >
            <i
              class="bi bi-search text-secondary position-absolute top-50 start-0 translate-middle-y ms-3"
            ></i>
            <input
              type="search"
              class="form-control form-control-sm rounded-5 border-0 ps-5 shadow-sm"
              placeholder="T√¨m ki·∫øm"
              style="background-color: #f0f2f5; height: 35px; width: 240px"
            />
          </form>
          <button
            class="btn btn-light d-block d-lg-none ms-2"
            id="mobileSearchBtn"
            type="button"
            onclick="toggleMobileSearch()"
          >
            <i class="bi bi-search fs-5 text-dark"></i>
          </button>
        </div>

        <!-- MENU ICONS GI·ªÆA (·∫©n tr√™n mobile, ho·∫∑c b·∫°n c√≥ th·ªÉ ƒëi·ªÅu ch·ªânh th√†nh collapse) -->
        <div class="d-none d-lg-flex mx-auto" id="menuTabs">
          <div class="d-flex justify-content-center text-center">
            <div class="menu-item px-5" data-link="index.html">
              <a href="#"><i class="bi bi-house-door-fill fs-4 active"></i></a>
              <div class="indicator"></div>
            </div>
            <div class="menu-item px-5 active" data-link="#">
              <a><i class="bi bi-people-fill fs-4"></i></a>
              <div class="indicator"></div>
            </div>
            <div class="menu-item px-5" data-link="/">
              <a href="reel.html"><i class="bi bi-play-btn-fill fs-4"></i></a>
              <div class="indicator"></div>
            </div>
            <div class="menu-item px-5" data-link="/">
              <a href="#"><i class="bi bi-bell-fill fs-4"></i></a>
              <div class="indicator"></div>
            </div>
          </div>
        </div>

        <!-- ICONS + AVATAR -->
        <div class="d-flex align-items-center gap-2 mt-2 mt-lg-0">
          <!-- App grid -->
          <div
            class="rounded-circle bg-secondary-subtle d-flex justify-content-center align-items-center"
            style="width: 40px; height: 40px; cursor: pointer"
            id="menuToggle"
          >
            <i class="bi bi-grid-3x3-gap-fill fs-5 text-dark"></i>
          </div>
          <div
            id="menuDropdown"
            class="position-absolute bg-white shadow rounded-4 p-3"
            style="
              top: 60px;
              right: 10px;
              width: 250px;
              display: none;
              z-index: 9999;
              font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
                'Helvetica Neue', Arial, sans-serif;
            "
          >
            <h5 class="mb-2" style="font-weight: 700; font-size: 25px">Menu</h5>
            <hr class="my-2" />

            <div class="px-1">
              <!-- üîµ Post -->
              <div
                class="dropdown-item py-2 d-flex align-items-center gap-3 rounded-3"
                style="cursor: pointer; transition: background 0.2s"
                onmouseover="this.style.background='#f0f2f5'"
                onmouseout="this.style.background='transparent'"
                onclick="openPostModal()"
              >
                <div
                  class="d-flex justify-content-center align-items-center"
                  style="
                    width: 44px;
                    height: 44px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #ff9a9e, #fad0c4);
                    margin-left: 10px;
                  "
                >
                  <i class="bi bi-file-post text-white fs-5"></i>
                </div>
                <span style="font-size: 15px; font-weight: 500">Post</span>
              </div>

              <!-- üü† Story -->
              <div
                class="dropdown-item py-2 d-flex align-items-center gap-3 rounded-3"
                style="cursor: pointer; transition: background 0.2s"
                onmouseover="this.style.background='#f0f2f5'"
                onmouseout="this.style.background='transparent'"
                onclick="window.location.href='tao_tin.html'"
              >
                <div
                  class="d-flex justify-content-center align-items-center"
                  style="
                    width: 44px;
                    height: 44px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #a18cd1, #fbc2eb);
                    margin-left: 10px;
                  "
                >
                  <i class="bi bi-book-half text-white fs-5"></i>
                </div>
                <span style="font-size: 15px; font-weight: 500">Story</span>
              </div>

              <!-- üü£ Reel -->
              <div
                class="dropdown-item py-2 d-flex align-items-center gap-3 rounded-3"
                style="cursor: pointer; transition: background 0.2s"
                onmouseover="this.style.background='#f0f2f5'"
                onmouseout="this.style.background='transparent'"
                onclick="window.location.href='tao_tin.html'"
              >
                <div
                  class="d-flex justify-content-center align-items-center"
                  style="
                    width: 44px;
                    height: 44px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #84fab0, #8fd3f4);
                    margin-left: 10px;
                  "
                >
                  <i class="bi bi-fast-forward-btn-fill text-white fs-5"></i>
                </div>
                <span style="font-size: 15px; font-weight: 500">Reel</span>
              </div>
              <div>
                <div
                  class="dropdown-item py-2 d-flex align-items-center gap-3 rounded-3"
                  style="cursor: pointer; transition: background 0.2s"
                  onmouseover="this.style.background='#f0f2f5'"
                  onmouseout="this.style.background='transparent'"
                >
                  <div
                    class="d-flex justify-content-center align-items-center"
                    style="
                      width: 44px;
                      height: 44px;
                      border-radius: 50%;
                      background: linear-gradient(135deg, #ecf0f1, #bdc3c7);
                      margin-left: 10px;
                    "
                  >
                    <i class="bi bi-moon-fill text-white fs-5"></i>
                  </div>
                  <div>
                    <span style="font-size: 15px; font-weight: 500"
                      >Dark mode</span
                    >
                    <form
                      class="darkmode-options"
                      style="display: flex; gap: 20px; font-size: 12px"
                    >
                      <label
                        style="
                          display: flex;
                          align-items: center;
                          cursor: pointer;
                        "
                      >
                        <input
                          type="radio"
                          name="darkmode"
                          value="off"
                          checked
                          style="margin-right: 6px"
                        />
                        Off
                      </label>
                      <label
                        style="
                          display: flex;
                          align-items: center;
                          cursor: pointer;
                        "
                      >
                        <input
                          type="radio"
                          name="darkmode"
                          value="on"
                          style="margin-right: 6px"
                        />
                        On
                      </label>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Messenger -->
          <div
            id="messengerBtn"
            class="rounded-circle bg-secondary-subtle d-flex justify-content-center align-items-center"
            style="width: 40px; height: 40px; cursor: pointer"
          >
            <i class="bi bi-messenger fs-5 text-dark"></i>
          </div>

          <!-- Sidebar Chat -->
          <div
            id="chatSidebar"
            class="chat-sidebar position-fixed top-0 end-0 bg-white dark-mode-bg p-3 shadow"
            style="
              width: 380px;
              height: 100vh;
              transform: translateX(100%);
              transition: transform 0.3s ease;
              z-index: 1050;
            "
          >
            <!-- Header -->
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h4 class="mb-0 fw-bold">ƒêo·∫°n chat</h4>
              <div class="d-flex align-items-center">
                <div
                  class="rounded-circle icon-wrapper d-flex justify-content-center align-items-center me-2"
                  style="width: 30px; height: 30px; cursor: pointer"
                >
                  <i class="bi bi-arrows-fullscreen"></i>
                </div>
                <button
                  class="btn-close btn-close-custom rounded-circle"
                  onclick="toggleChatSidebar()"
                ></button>
              </div>
            </div>

            <!-- T√¨m ki·∫øm -->
            <form
              class="d-none d-md-flex mb-3"
              style="position: relative; width: 100%"
            >
              <i
                class="bi bi-search text-secondary position-absolute top-50 start-0 translate-middle-y ms-3"
              ></i>
              <input
                type="search"
                class="form-control form-control-sm rounded-5 border-0 ps-5 shadow-sm"
                placeholder="Search"
                style="background-color: #f0f2f5; height: 35px; width: 100%"
              />
            </form>

            <!-- M·ªôt d√≤ng chat -->
            <div class="d-flex align-items-center gap-2 mb-3 chat-hover">
              <img
                src="../images/OIP.jpg"
                class="rounded-circle"
                style="width: 48px; height: 48px"
              />
              <div>
                <div class="fw-semibold">Ho√†ng ƒê·ª©c</div>
                <div class="text-muted" style="font-size: 13px">
                  sent a photo ¬∑ 4h
                </div>
              </div>
            </div>
          </div>

          <!-- Bell -->
          <div
            class="rounded-circle bg-secondary-subtle d-flex justify-content-center align-items-center"
            style="width: 40px; height: 40px; cursor: pointer"
          >
            <i class="bi bi-bell fs-5 text-dark"></i>
          </div>

          <!-- Avatar -->
          <div
            class="rounded-circle d-flex align-items-center justify-content-center position-relative"
            style="width: 40px; height: 40px; overflow: hidden; cursor: pointer"
          >
            <img
              src="../images/OIP.jpg"
              class="rounded-circle userAvatar"
              alt="avatar"
              style="width: 40px; height: 40px"
            />
          </div>

          <!-- Dark mode -->
        </div>
      </div>
    </nav>

    <!-- Main Layout -->
    <div class="container-fluid mt-3">
      <div class="row justify-content-center">
        <!-- Sidebar tr√°i -->
        <div class="col-lg-3">
          <div class="left-sidebar shadow-sm p-3 rounded full-height-sidebar">
            <h3 class="mb-3 fw-bold">B·∫°n b√®</h3>
            <ul class="nav flex-column">
              <li class="nav-item">
                <a
                  class="nav-link active"
                  href="#"
                  onclick="showSection('home')"
                >
                  <i class="bi bi-house-fill"></i> Trang ch·ªß
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#" onclick="showSection('requests')">
                  <i class="bi bi-person-plus-fill"></i> L·ªùi m·ªùi k·∫øt b·∫°n
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#" onclick="showSection('all')">
                  <i class="bi bi-person-lines-fill"></i> T·∫•t c·∫£ b·∫°n b√®
                </a>
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  href="#"
                  onclick="showSection('suggestions')"
                >
                  <i class="bi bi-person-plus me-2"></i> G·ª£i √Ω
                </a>
              </li>
            </ul>
          </div>
        </div>

        <!-- N·ªôi dung ch√≠nh: trang friends -->
        <div class="col-lg-9">
          <div
            id="friendContainer"
            class="friend-section row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-3 mb-3"
          >
            <!-- C√°c ph·∫ßn t·ª≠ b·∫°n b√® s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
          </div>
          <div id="friend-request" class="friend-section d-none">
            <h5 class="fw-bold mb-3">L·ªùi m·ªùi k·∫øt b·∫°n</h5>
            <div
              id="friendRequests"
              class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-3"
            ></div>
          </div>
          <div id="all-friend" class="friend-section d-none">
            <h5 class="fw-bold mb-3">T·∫•t c·∫£ b·∫°n b√®</h5>
            <div
              id="allFriends"
              class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-3"
            ></div>
          </div>

          <!-- Suggestions -->
          <div id="friend-suggestions" class="friend-section d-none">
            <h5 class="fw-bold mb-3">G·ª£i √Ω</h5>
            <div
              id="friendSuggestions"
              class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-3"
            ></div>
          </div>
          <!-- <div id="scrollSentinel" class="text-center py-4">
            <div
              class="spinner-border text-primary"
              role="status"
              id="loadingSpinner"
            ></div>
          </div> -->
        </div>
      </div>
    </div>

    <!-- Bootstrap & Dark Mode JS -->
    <script>
      const menuToggle = document.getElementById("menuToggle");
      const menuDropdown = document.getElementById("menuDropdown");

      menuToggle.addEventListener("click", function (e) {
        e.stopPropagation(); // NgƒÉn s·ª± ki·ªán lan ra ngo√†i
        const isVisible = menuDropdown.style.display === "block";
        menuDropdown.style.display = isVisible ? "none" : "block";
      });

      // Click ngo√†i th√¨ ·∫©n menu
      document.addEventListener("click", function () {
        menuDropdown.style.display = "none";
      });
      const darkModeRadios = document.querySelectorAll(
        'input[name="darkmode"]'
      );

      function setDarkMode(isOn) {
        if (isOn) {
          document.body.classList.add("dark-mode");
          localStorage.setItem("darkMode", "on");
        } else {
          document.body.classList.remove("dark-mode");
          localStorage.setItem("darkMode", "off");
        }
      }

      // Khi load trang, set radio v√† class body theo tr·∫°ng th√°i l∆∞u
      window.addEventListener("DOMContentLoaded", () => {
        const darkModeStatus = localStorage.getItem("darkMode") || "off";
        setDarkMode(darkModeStatus === "on");

        darkModeRadios.forEach((radio) => {
          radio.checked = radio.value === darkModeStatus;
        });
      });

      // B·∫Øt s·ª± ki·ªán thay ƒë·ªïi radio ƒë·ªÉ b·∫≠t/t·∫Øt dark mode
      darkModeRadios.forEach((radio) => {
        radio.addEventListener("change", () => {
          setDarkMode(radio.value === "on");
        });
      });
    </script>
    <script>
      // ·∫®n to√†n b·ªô section

      // M·∫∑c ƒë·ªãnh hi·ªÉn th·ªã All Friends
      document.addEventListener("DOMContentLoaded", () => {
        showSection("home");
      });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- AI Assistant Button -->
    <!-- AI Assistant Button with Gradient Border -->
    <div
      style="
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 60px;
        height: 60x;
        padding: 3px; /* vi·ªÅn gi·∫£ */
        background: conic-gradient(
          from 0deg,
          #ff0080,
          #7928ca,
          #2afadf,
          #ff0080
        );
        border-radius: 50%;
        z-index: 9999;
        cursor: pointer;
      "
      onclick="window.location.href='chatbot.html'"
      id="ai"
    >
      <div
        style="
          width: 100%;
          height: 100%;
          background-color: white; /* m√†u n·ªÅn b√™n trong */
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
        "
      >
        <img
          src="../images/OIP.webp"
          alt="Tr·ª£ l√Ω ·∫£o"
          style="
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
          "
        />
      </div>
    </div>
    <div class="modal fade" id="postModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" style="max-width: 500px">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title w-100 text-center" style="font-weight: bold">
              Create post
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <div class="d-flex align-items-center">
              <img
                src="../images/OIP.jpg"
                alt="Avatar"
                class="rounded-circle me-2"
                style="width: 40px; height: 40px"
              />
              <div>
                <strong>Nguy·ªÖn VƒÉn A</strong>
                <!-- Dropdown ch·ªçn ch·∫ø ƒë·ªô hi·ªÉn th·ªã -->
                <div class="dropdown">
                  <button
                    class="btn btn-light border dropdown-toggle d-flex align-items-center px-2 py-1 mt-1"
                    type="button"
                    id="privacyDropdown"
                    data-bs-toggle="dropdown"
                    aria-expanded="false"
                    style="font-size: 10px; border-radius: 15px"
                  >
                    <i class="bi bi-globe me-1"></i>
                    <span id="privacyLabel">Public</span>
                  </button>
                  <ul class="dropdown-menu" aria-labelledby="privacyDropdown">
                    <li>
                      <a
                        class="dropdown-item"
                        href="#"
                        onclick="setPrivacy('public')"
                      >
                        <i class="bi bi-globe me-2"></i> C√¥ng khai
                      </a>
                    </li>
                    <li>
                      <a
                        class="dropdown-item"
                        href="#"
                        onclick="setPrivacy('private')"
                      >
                        <i class="bi bi-lock-fill me-2"></i>Ri√™ng t∆∞
                      </a>
                    </li>
                  </ul>
                  <input
                    type="hidden"
                    id="privacyValue"
                    name="privacy"
                    value="public"
                  />
                </div>
              </div>
            </div>

            <!-- N·ªôi dung b√†i vi·∫øt -->
            <div style="overflow-y: auto; max-height: 450px">
              <div style="margin: 20px 0">
                <textarea
                  id="postContent"
                  class="form-control"
                  placeholder="What's on your mind?"
                  style="
                    overflow: hidden;
                    resize: none;
                    min-height: 38px;
                    line-height: 1.5;
                    border-radius: 8px;
                    padding: 8px;
                    font-size: 16px;
                    background-color: #f8f9fa;
                  "
                  oninput="autoResize(this)"
                ></textarea>
              </div>

              <!-- Khu v·ª±c preview ·∫£nh -->
              <div
                id="imagePreviewContainer"
                class="d-none d-flex flex-wrap gap-2 mt-3 rounded-3"
                style="height: 350px"
              ></div>
            </div>

            <!-- nh·∫≠p -->
            <div>
              <div></div>
              <div></div>
            </div>
            <!-- Input b·ªã ·∫©n ·∫¢nh ho·∫∑c video-->
            <div
              class="rounded-3 d-flex"
              style="
                background-color: #f8f9fa;
                height: 50px;
                border: 0.5px solid #bdc3c7;
                margin-top: 5px;
                align-items: center;
                justify-content: space-between;
                margin-top: 10p;
              "
            >
              <p style="margin: auto 10px">Th√™m v√†o b√†i vi·∫øt c·ªßa b·∫°n</p>
              <input
                type="file"
                id="fileInput"
                class="d-none"
                accept="image/*,video/*"
                multiple
                onchange="handleMultipleImages(this)"
              />

              <!-- Label hi·ªÉn th·ªã icon -->
              <label for="fileInput" style="cursor: pointer; margin: 0 10px">
                <i class="bi bi-image fs-4" style="color: #2ecc71"></i>
                <!-- Icon h√¨nh ·∫£nh Bootstrap -->
              </label>
            </div>
          </div>

          <div class="modal-footer">
            <button
              id="postBtn"
              class="btn btn-primary w-100"
              onclick="submitPost()"
            >
              <span id="postBtnText">ƒêƒÉng</span>
              <span
                id="postBtnSpinner"
                class="spinner-border spinner-border-sm d-none ms-2"
                role="status"
                aria-hidden="true"
              ></span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script>
    const menuItems = document.querySelectorAll("#menuTabs .menu-item");

    menuItems.forEach((item) => {
      item.addEventListener("click", () => {
        // Xo√° active ·ªü t·∫•t c·∫£
        menuItems.forEach((el) => el.classList.remove("active"));
        // Th√™m active v√†o ph·∫ßn t·ª≠ v·ª´a click
        item.classList.add("active");

        // L·∫•y ƒë∆∞·ªùng d·∫´n t·ª´ thu·ªôc t√≠nh data-link v√† chuy·ªÉn trang
        const link = item.getAttribute("data-link");
        if (link) {
          window.location.href = link;
        }
      });
    });
  </script>
  <script src="../Js/mess.js"></script>
  <script src="../Js/api-get-friends.js"></script>
  <script src="../Js/model.js"></script>
  <!-- nh·ªõ th√™m n·∫øu b·∫°n d√πng SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</html>
